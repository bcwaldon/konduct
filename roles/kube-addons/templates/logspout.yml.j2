apiVersion: v1
kind: ReplicationController
metadata:
  name: kube-logspout
  namespace: kube-system
spec:
  replicas: 1
  selector:
    app: kube-logspout
  template:
    metadata:
      labels:
        app: kube-logspout
    spec:
      containers:
      - name: logspout
        image: gliderlabs/logspout:v3.1
        imagePullPolicy: Always
        args:
        - {{ logspout_syslog_host }}
        volumeMounts:
        - mountPath: /var/run/docker.sock
          name: docker-sock
        env:
        - name: SYSLOG_FORMAT
          value: rfc3164
        - name: SYSLOG_HOSTNAME
          value: "{{ index .Container.Config.Labels 'io.kubernetes.pod.namespace' }}"
        - name: SYSLOG_TAG
          value: klondike-{{ cluster }}-"{{ index .Container.Config.Labels 'io.kubernetes.pod.namespace' }}-{{ index .Container.Config.Labels 'io.kubernetes.pod.name' }}"
      volumes:
      - name: docker-sock
        hostPath:
          path: /var/run/docker.sock
